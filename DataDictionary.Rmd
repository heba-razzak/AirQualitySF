---
title: "DataDictionary"
output: github_document
---

```{r, load-libraries, message = FALSE, warning = FALSE}
library(dplyr) # For data manipulation
library(sf) # For working with spatial data
library(data.table)

# install package from github
library(devtools)
install_github("heba-razzak/createDataDict")
library(createDataDict)
```

```{r, read-osm-roads, message=FALSE, warning=FALSE}
# osm file directory
file_directory = readr::read_file("inputs/osm_directory.txt")

# read roads file
sanfrancell_roads <- st_read(paste0(file_directory,"/sanfrangrid_roads_osm.shp"), quiet = TRUE)

# print skeleton for filling in descriptions
descriptions <- descriptions_df(sanfrancell_roads)
```


```{r, osm-roads-datadict}
# edit descriptions dataframe
descriptions[descriptions$Variable=="osm_id",]["Description"] <- "Unique Identifier from OpenStreetMap"

# Print data dictionary
print_data_dict(sanfrancell_roads, title="OSM Roads", descriptions=descriptions)
```

## **OSM Roads**  
**Number of Rows**: `1077985`

|Variable |Type           |      NA|  %NA|  Unique|Description                          |
|:--------|:--------------|-------:|----:|-------:|:------------------------------------|
|osm_id   |character      |       0|  0.0| 1057749|Unique Identifier from OpenStreetMap |
|name     |character      |  745113| 69.1|   98062|name_description                     |
|highway  |character      |      96|  0.0|      36|highway_description                  |
|lanes    |character      |  958937| 89.0|      15|lanes_description                    |
|maxspeed |character      | 1004397| 93.2|      32|maxspeed_description                 |
|geom     |sfc_LINESTRING |       0|  0.0| 1057739|geom_description                     |


```{r, purpleair}
file_directory = readr::read_file("inputs/purpleair_directory.txt")
# Read purple air data (get filename for full data then read it)
file_paths <- list.files(file_directory, pattern = "purple_air_sanfran_.*.csv", full.names = FALSE)
from = "9999-99-99"
to = "0000-00-00"
for (f in file_paths) {
  from = min(from,substr(f,20,29))
  to = max(to,substr(f,31,40))
}
purpleair <- read.csv(paste0("purple_air_sanfran_", from, "_", to, ".csv"))

```